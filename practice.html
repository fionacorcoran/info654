<!DOCTYPE html>
<html lang="en">
    <head> 
        <meta charset="UTF-8">
        <title>Tree Census</title>
        <link rel="stylesheet" type="text/css" href="practice.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- <script>
            const APP_TOKEN = "EuUJxbkjULlp0gbbri4FLO9hK"
            async function fetchTreeReport () {
              const neighborhood = document.getElementById('neighborhood').value.trim();
              const soqlQuery = `SELECT spc_common AS tree_type, COUNT(*) AS quantity WHERE nta_name='${neighborhood}' GROUP BY spc_common ORDER BY quantity DESC`;
              const url = `https://data.cityofnewyork.us/api/v3/views/uvpi-gqnh/query.json?pageNumber=1&pageSize=100&app_token=${APP_TOKEN}&query=${encodeURIComponent(soqlQuery)}`;
              const results = document.getElementById('results');
              results.innerHTML = "";
              if (!neighborhood) {
                alert("Please enter a neighborhood name!");
                return;
                }
              try {
                const response = await fetch(url);
                const json = await response.json();

              if (!json.data) {
                results.innerHTML = "<li>No results found or query error.</li>";
                console.error(json);
                return;
                }
              json.data.forEach (row => {
                const treeType = row.rowData[0] || "Unknown";
                const quantity = row.rowData[1];
                const li = document.createElement('li');
                li.textContent = `${treeType}: ${quantity}`;
                results.appendChild(li);
              });
            }
        </script> -->
        <script>
            const APP_TOKEN = "EuUJxbkjULlp0gbbri4FLO9hK";

            async function fetchTreeReport() {
                const neighborhood = document.getElementById('neighborhood').value.trim();
                const results = document.getElementById('results');
                results.innerHTML = "";

                if (!neighborhood) {
                    alert("Please enter a neighborhood name!");
                    return;
                }

                const url = `https://data.cityofnewyork.us/resource/uvpi-gqnh.json?$select=spc_common,count(*) as quantity&$where=nta_name='${neighborhood}'&$group=spc_common&$order=quantity DESC&$$app_token=${APP_TOKEN}`;

                try {
                    const response = await fetch(url);
                    const json = await response.json();

                if (!json.data) {
                    results.innerHTML = "<li>No results found or query error.</li>";
                    console.error(json);
                    return;
                }

                json.data.forEach(row => {
                const treeType = row.rowData[0] || "Unknown";
                const quantity = row.rowData[1];
                const li = document.createElement('li');
                li.textContent = `${treeType}: ${quantity}`;
                results.appendChild(li);
                });
            } catch (err) {
                console.error("Fetch error:", err);
                results.innerHTML = "<li>Error fetching data.</li>";
            }
         }
         </script>
    </head> 
    <body>
        <div>
            <h2>ðŸŒ³ NYC Tree Census - 2015 Neighborhood Report</h2>
            <p>Enter a neighborhood name (e.g., <b>Astoria</b>, <b>Harlem</b>, <b>Park Slope</b>)</p>
            
            <input id="neighborhood" type="text" placeholder="e.g. Astoria" />
            <button onclick="fetchTreeReport()">Get Tree Report</button>
            
            <ul id="results"></ul>
        </div>
        <div class ="marquee">
            <p class ="marquee-scroll"><b>THE 2025 TREE CENSUS IS UNDERWAY!&nbsp;&nbsp;&nbsp;HAVE YOUR TREES BEEN COUNTED?</b></p>
            <p class ="marquee-scroll"><b>THE 2025 TREE CENSUS IS UNDERWAY!&nbsp;&nbsp;&nbsp;HAVE YOUR TREES BEEN COUNTED?</b></p>
        </div>
    </body> 
</html>